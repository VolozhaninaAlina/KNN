# KNN

–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –æ–±—É—á–µ–Ω–∏—è ‚Äî –º–µ—Ç–æ–¥—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ —Å—Ö–æ–¥—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤. (similarity-based learning, distance-based learning).
–í –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ª–µ–∂–∏—Ç –≥–∏–ø–æ—Ç–µ–∑–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏. 

**–ì–∏–ø–æ—Ç–µ–∑–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏**: –°—Ö–æ–∂–∏–º –æ–±—ä–µ–∫—Ç–∞–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ö–æ–∂–∏–µ –æ—Ç–≤–µ—Ç—ã.

–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–æ–π $$ ùëã^ùëô $$ –æ—Ç–Ω–æ—Å–∏—Ç –æ–±—ä–µ–∫—Ç ùë¢ –∫ —Ç–æ–º—É –∫–ª–∞—Å—Å—É ùë¶ùúñùëå, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ —Å—É–º–º–∞—Ä–Ω—ã–π –≤–µ—Å –±–ª–∏–∂–∞–π—à–∏—Ö –æ–±—É—á–∞—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ W_ùë¶(ùë¢, ùëã^ùëô) –º–∞–∫—Å–∏–º–∞–ª–µ–Ω:

**–ê–ª–≥–æ—Ä–∏—Ç–º**

–î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

 1.–í—ã—á–∏—Å–ª–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏

 2.–û—Ç–æ–±—Ä–∞—Ç—å k –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–æ—Ç–æ—Ä—ã—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω–æ

 3.–ö–ª–∞—Å—Å –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å, –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–π—Å—è —Å—Ä–µ–¥–∏ k –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π
 
**–ö–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã**

–ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –∏–∑–≤–ª–µ–∫–∞–µ–º –ø–∞–∫–µ—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º–∏. 
```python
 print(__doc__)

import numpy as np
import matplotlib.pyplot as plt
from matplotlib.colors import ListedColormap
from sklearn import neighbors, datasets
```
–ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ( –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å–µ–¥–µ–π –∏ —à–∞–≥), –∞ —Ç–∞–∫ –∂–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º–∏. 
```python
# –ó–∞–¥–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å–µ–¥–µ–π.
n_neighbors = 15

#–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏ –ò—Ä–∏—Å–æ–≤ 
iris = datasets.load_iris()

# –ü—Ä–∏–Ω–∏–º–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ –¥–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã(—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏) –ò—Ä–∏—Å–æ–≤ 
X = iris.data[:, :2]
y = iris.target

h = .02  # –ó–∞–¥–∞–µ–º —Ä–∞–∑–º–µ—Ä —à–∞–≥–∞

# –ó–∞–¥–∞–µ–º —Ü–≤–µ—Ç–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–∞—Ä—Ç 
cmap_light = ListedColormap(['#FFAAAA', '#AAFFAA', '#AAAAFF']) #—Ü–≤–µ—Ç –æ–±–ª–∞—Å—Ç–µ–π
cmap_bold = ListedColormap(['#FF0000', '#00FF00', '#0000FF']) #—Ü–≤–µ—Ç –ò—Ä–∏—Å–æ–≤ –∏–∑ –≤—ã–±–æ—Ä–∫–∏ 
```
–°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Å–æ—Å–µ–¥–µ–π, –ø–µ—Ä–µ–¥–∞–µ–º –µ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:–• -–≤—ã–±–æ—Ä–∫—É –±–µ–∑ –∫–ª–∞—Å—Å–æ–≤, –£ - –∫–ª–∞—Å—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤—ã–±–æ—Ä–∫–∏ –∏ —Ç–∏–ø –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ['uniform', 'distance']
```python
for weights in ['uniform', 'distance']:
    clf = neighbors.KNeighborsClassifier(n_neighbors, weights=weights)
    clf.fit(X, y)
 ```
–û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
```python
# –í—ã–¥–µ–ª—è–µ–º –≥—Ä–∞–Ω–∏—Ü—É —Ä–µ—à–µ–Ω–∏—è, –Ω–∞–∑–Ω–∞—á–∞—è —Ü–≤–µ—Ç –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ [x_min, x_max] x [y_min, y_max].
    x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1
    y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1
    xx, yy = np.meshgrid(np.arange(x_min, x_max, h),
                         np.arange(y_min, y_max, h))
    all_points = np.c_[xx.ravel(), yy.ravel()] 
    Z = clf.predict(all_points)

    # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç 
    Z = Z.reshape(xx.shape)
    plt.figure()
    plt.pcolormesh(xx, yy, Z, cmap=cmap_light)

    # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏—Å—Ö–æ–¥–Ω—É—é –≤—ã–±–æ—Ä–∫—É 
    plt.scatter(X[:, 0], X[:, 1], c=y, cmap=cmap_bold,
                edgecolor='k', s=10)
    plt.xlim(xx.min(), xx.max())
    plt.ylim(yy.min(), yy.max())
    plt.title("3-Class classification (k = %i, weights = '%s')"
              % (n_neighbors, weights))

plt.show()
 ```
–û—Å–Ω–æ–≤–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–µ –≤–µ—Å–∞: —Ç–æ –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω–æ–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–π —Ç–æ—á–∫–µ, –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å —É—á–µ—Ç–æ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –≥–æ–ª–æ—Å–æ–≤ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π. –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –ª—É—á—à–µ —É–±–∏—Ä–∞—Ç—å —Å–æ—Å–µ–¥–µ–π —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –±–ª–∏–∂–∞–π—à–∏–µ —Å–æ—Å–µ–¥–∏ –∏–º–µ–ª–∏ –±–æ–ª—å—à–∏–π –≤–µ—Å. –≠—Ç–æ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ weight. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, **weight = 'uniform'**, –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤–µ—Å–∞ –∫–∞–∂–¥–æ–º—É —Å–æ—Å–µ–¥—É. 

![](https://raw.githubusercontent.com/VolozhaninaAlina/KNN/master/1.PNG)

**weights = 'distance'** –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –≤–µ—Å–∞–º –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞—Ç–Ω–æ–º—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é –æ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–π —Ç–æ—á–∫–∏. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–µ—Å–æ–≤.

![](https://raw.githubusercontent.com/VolozhaninaAlina/KNN/master/2.PNG)
